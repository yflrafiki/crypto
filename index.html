<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CryptoVault - Secure Crypto Trading Platform</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="dark-mode">
    <!-- Landing Page -->
    <div id="landingPage" class="landing-page">
        <nav class="landing-nav">
            <div class="container">
                <div class="logo">Crypto Edge</div>
                <div class="landing-nav-links">
                    <a href="#features">Features</a>
                    <a href="#how-it-works">How It Works</a>
                    <a href="#security">Security</a>
                    <button class="btn" onclick="showAuthScreen()">Get Started</button>
                </div>
            </div>
        </nav>

        <header class="landing-header">
            <div class="container">
                <div class="hero-content">
                    <h1>Your Gateway to <span class="gradient-text">Crypto Investing</span></h1>
                    <p class="subtitle">Buy, sell, and manage cryptocurrencies with ease on our secure platform</p>
                    <div class="hero-btns">
                        <button class="btn btn-primary" onclick="showAuthScreen()">Start Trading</button>
                        <button class="btn btn-outline" onclick="document.querySelector('#features').scrollIntoView()">Learn More</button>
                    </div>
                    <div class="bitcoin-price-ticker">
                        <i class="fab fa-bitcoin"></i>
                        <span>BTC: <span id="landingBtcPrice">Loading...</span></span>
                        <span id="landingBtcChange" class="positive">+0.00%</span>
                    </div>
                </div>
                <div class="hero-image">
                   
                </div>
            </div>
        </header>

        <section id="features" class="landing-section">
            <div class="container">
                <h2>Why Choose Crypto Edge?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <h3>Bank-Level Security</h3>
                        <p>Your assets are protected with multi-signature wallets and cold storage solutions.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h3>Instant Trading</h3>
                        <p>Buy and sell cryptocurrencies instantly with competitive market rates.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h3>Advanced Analytics</h3>
                        <p>Track your portfolio performance with detailed charts and insights.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h3>Multiple Payment Options</h3>
                        <p>Deposit via bank transfer, PayPal, and credit cards.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="how-it-works" class="landing-section">
            <div class="container">
                <h2>How It Works</h2>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h3>Create Your Account</h3>
                            <p>Sign up in minutes with just your email and a secure password.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h3>Deposit Funds</h3>
                            <p>Add money to your account using your preferred payment method.</p>
                        </div>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h3>Start Trading</h3>
                            <p>Buy, sell, and convert cryptocurrencies with just a few clicks.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="security" class="landing-section dark-bg">
            <div class="container">
                <h2>Your Security Is Our Priority</h2>
                <div class="security-features">
                    <div class="security-item">
                        <i class="fas fa-fingerprint"></i>
                        <h3>2FA Authentication</h3>
                    </div>
                    <div class="security-item">
                        <i class="fas fa-lock"></i>
                        <h3>Encrypted Storage</h3>
                    </div>
                    <div class="security-item">
                        <i class="fas fa-user-shield"></i>
                        <h3>Insurance Protection</h3>
                    </div>
                    <div class="security-item">
                        <i class="fas fa-history"></i>
                        <h3>Activity Monitoring</h3>
                    </div>
                </div>
            </div>
        </section>

        <footer class="landing-footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-logo">
                        <div class="logo">CryptoVault</div>
                        <p>Secure cryptocurrency trading platform</p>
                    </div>
                    <div class="footer-links">
                        <div class="link-group">
                            <h4>Company</h4>
                            <a href="#">About Us</a>
                            <a href="#">Careers</a>
                            <a href="#">Press</a>
                        </div>
                        <div class="link-group">
                            <h4>Resources</h4>
                            <a href="#">Blog</a>
                            <a href="#">Help Center</a>
                            <a href="#">API</a>
                        </div>
                        <div class="link-group">
                            <h4>Legal</h4>
                            <a href="#">Privacy Policy</a>
                            <a href="#">Terms of Service</a>
                            <a href="#">Risk Disclosure</a>
                        </div>
                    </div>
                </div>
                <div class="footer-bottom">
                    <p>Â© 2023 CryptoVault. All rights reserved.</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-linkedin"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Auth Screen -->
    <div id="authScreen" class="auth-screen" style="display: none;">
        <div class="auth-card slide-in">
            <h1 class="auth-title">CryptoVault</h1>
            <p style="margin-bottom: 2rem; color: rgba(255,255,255,0.8);">Your gateway to crypto investing</p>
            
            <div id="loginForm">
                <div class="form-group">
                    <label>Email <span class="required">*</span></label>
                    <input type="email" id="loginEmail" placeholder="Enter your email" required>
                    <div class="error-message" id="loginEmailError"></div>
                </div>
                <div class="form-group">
                    <label>Password <span class="required">*</span></label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                    <div class="error-message" id="loginPasswordError"></div>
                </div>
                <div class="form-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="rememberMe">
                        <span class="checkmark"></span>
                        Remember me
                    </label>
                    <a href="#" class="forgot-password">Forgot password?</a>
                </div>
                <button class="btn" onclick="validateLogin()">Sign In</button>
                <button class="btn btn-secondary" onclick="showRegister()">Create Account</button>
                <div class="auth-divider">
                    <span>or continue with</span>
                </div>
                <div class="social-auth">
                    <button class="social-btn google">
                        <i class="fab fa-google"></i> Google
                    </button>
                    <button class="social-btn apple">
                        <i class="fab fa-apple"></i> Apple
                    </button>
                </div>
            </div>
            
            <div id="registerForm" style="display: none;">
                <div class="form-group">
                    <label>Full Name <span class="required">*</span></label>
                    <input type="text" id="regName" placeholder="Enter your name" required>
                    <div class="error-message" id="regNameError"></div>
                </div>
                <div class="form-group">
                    <label>Email <span class="required">*</span></label>
                    <input type="email" id="regEmail" placeholder="Enter your email" required>
                    <div class="error-message" id="regEmailError"></div>
                </div>
                <div class="form-group">
                    <label>Password <span class="required">*</span></label>
                    <input type="password" id="regPassword" placeholder="Create a password (min 8 characters)" required minlength="8">
                    <div class="error-message" id="regPasswordError"></div>
                </div>
                <div class="form-group">
                    <label>Confirm Password <span class="required">*</span></label>
                    <input type="password" id="regConfirmPassword" placeholder="Confirm your password" required>
                    <div class="error-message" id="regConfirmPasswordError"></div>
                </div>
                <div class="form-group">
                    <label class="checkbox-container">
                        <input type="checkbox" id="acceptTerms" required>
                        <span class="checkmark"></span>
                        I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a>
                    </label>
                </div>
                <button class="btn" onclick="validateRegister()">Create Account</button>
                <button class="btn btn-secondary" onclick="showLogin()">Back to Sign In</button>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp" class="main-content" style="display: none;">
        <!-- Sidebar -->
        <div id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="logo">CryptoVault</div>
                <button id="sidebarToggle" class="sidebar-toggle">
                    <i class="fas fa-chevron-left"></i>
                </button>
            </div>
            
            <div class="sidebar-menu">
                <div class="menu-section">
                    <div class="menu-item active" onclick="showSection('dashboard')">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </div>
                    <div class="menu-item" onclick="showSection('portfolio')">
                        <i class="fas fa-wallet"></i>
                        <span>Portfolio</span>
                    </div>
                    <div class="menu-item" onclick="showSection('markets')">
                        <i class="fas fa-coins"></i>
                        <span>Markets</span>
                    </div>
                    <div class="menu-section">
                        <div class="menu-item" onclick="showSection('transfer')">
                        <i class="fas fa-paper-plane"></i>
                        <span>Transfer</span>
                        </div>
                    </div>
                </div>
                
                <div class="menu-section">
                    <div class="menu-item" onclick="showSection('buy')">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Buy Crypto</span>
                    </div>
                    <div class="menu-item" onclick="showSection('sell')">
                        <i class="fas fa-cash-register"></i>
                        <span>Sell Crypto</span>
                    </div>
                    <div class="menu-item" onclick="showSection('convert')">
                        <i class="fas fa-exchange-alt"></i>
                        <span>Convert</span>
                    </div>
                    <div class="menu-item" onclick="showSection('deposit')">
                        <i class="fas fa-hand-holding-usd"></i>
                        <span>Deposit</span>
                    </div>
                </div>
                
                <div class="menu-section">
                    <div class="menu-item" onclick="showSection('settings')">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </div>
                    <div class="menu-item" id="themeToggle">
                        <i class="fas fa-moon"></i>
                        <span>Dark Mode</span>
                    </div>
                </div>
            </div>
            
            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="avatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="user-info">
                        <div class="name" id="sidebarUserName">Loading...</div>
                        <div class="email" id="sidebarUserEmail">loading@example.com</div>
                    </div>
                </div>
                <button class="btn btn-logout" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i>
                    <span>Logout</span>
                </button>
            </div>
        </div>

        <!-- Main Content Area -->
        <div class="main-content-area">
            <header class="header">
                <div class="container">
                    <div class="header-left">
                        <button id="mobileSidebarToggle" class="mobile-sidebar-toggle">
                            <i class="fas fa-bars"></i>
                        </button>
                        <div class="page-title" id="pageTitle">Dashboard</div>
                    </div>
                    <div class="header-right">
                        <div class="bitcoin-price">
                            <i class="fab fa-bitcoin"></i>
                            <span>BTC: <span id="currentBtcPrice">Loading...</span></span>
                            <span id="btcChange24h" class="positive">+0.00%</span>
                        </div>
                        <div class="user-balance">
                            <span>Balance:</span>
                            <span class="balance-amount">$<span id="userBalance">10000.00</span></span>
                        </div>
                        <div class="notifications">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">3</span>
                        </div>
                    </div>
                </div>
            </header>

            <div class="container">
                <!-- Dashboard Section -->
                <section id="dashboard" class="section">
                    <div class="dashboard-grid">
                        <div class="card">
                            <h2 class="card-title">Portfolio Performance</h2>
                            <div class="portfolio-value">$<span id="portfolioValue">10000.00</span></div>
                            <div class="portfolio-change">
                                <span id="portfolioChange" class="positive">+$0.00 (0.00%)</span>
                                <span>Last 24h</span>
                            </div>
                            <div class="chart-container">
                                <canvas id="portfolioChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="card">
                            <h2 class="card-title">Quick Stats</h2>
                            <div class="stats-grid">
                                <div class="stat-item">
                                    <div class="stat-label">Available Balance</div>
                                    <div class="stat-value">$<span id="availableBalance">10000.00</span></div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label">Total Invested</div>
                                    <div class="stat-value">$<span id="totalInvested">0.00</span></div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label">24h Change</div>
                                    <div class="stat-value"><span id="dayChange" class="positive">+0.00%</span></div>
                                </div>
                                <div class="stat-item">
                                    <div class="stat-label">Holdings</div>
                                    <div class="stat-value"><span id="holdingsCount">0 assets</span></div>
                                </div>
                            </div>
                            
                            <div class="quick-actions">
                                <button class="quick-action-btn" onclick="showSection('buy')">
                                    <i class="fas fa-plus"></i>
                                    <span>Buy</span>
                                </button>
                                <button class="quick-action-btn" onclick="showSection('sell')">
                                    <i class="fas fa-minus"></i>
                                    <span>Sell</span>
                                </button>
                                <button class="quick-action-btn" onclick="showSection('deposit')">
                                    <i class="fas fa-dollar-sign"></i>
                                    <span>Deposit</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Top Cryptocurrencies</h2>
                            <a href="#" class="view-all" onclick="showSection('markets')">View All</a>
                        </div>
                        <div class="crypto-list" id="cryptoList">
                            <!-- Crypto items will be populated by JavaScript -->
                        </div>
                    </div>
                </section>

                <!-- Portfolio Section -->
                <section id="portfolio" class="section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Your Holdings</h2>
                            <div class="portfolio-filter">
                                <button class="filter-btn active">All Assets</button>
                                <button class="filter-btn">Cryptocurrencies</button>
                                <button class="filter-btn">Favorites</button>
                            </div>
                        </div>
                        <div class="holdings-grid" id="holdingsGrid">
                            <p style="text-align: center; color: rgba(255,255,255,0.6); padding: 2rem;">
                                No holdings yet. Start by buying some cryptocurrency!
                            </p>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Asset Allocation</h2>
                        <div class="allocation-chart-container">
                            <canvas id="allocationChart"></canvas>
                        </div>
                    </div>
                </section>

                <!-- Markets Section -->
                <section id="markets" class="section" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">All Markets</h2>
                            <div class="search-bar">
                                <i class="fas fa-search"></i>
                                <input type="text" placeholder="Search cryptocurrencies...">
                            </div>
                        </div>
                        <div class="markets-table">
                            <div class="table-header">
                                <div class="table-cell">Asset</div>
                                <div class="table-cell">Price</div>
                                <div class="table-cell">24h Change</div>
                                <div class="table-cell">Market Cap</div>
                                <div class="table-cell">Action</div>
                            </div>
                            <div class="crypto-list" id="allMarkets">
                                <!-- All crypto items will be populated by JavaScript -->
                            </div>
                        </div>
                    </div>
                </section>
                <section id="transfer" class="section" style="display: none;">
    <div class="card">
        <h2 class="card-title">Transfer Cryptocurrency</h2>
        <div class="transfer-form">
            <div class="form-group">
                <label>Recipient Address <span class="required">*</span></label>
                <input type="text" id="transferRecipient" placeholder="Enter wallet address or email">
            </div>
            
            <div class="form-group">
                <label>Cryptocurrency <span class="required">*</span></label>
                <select id="transferCrypto" class="form-select">
                    <option value="">Select cryptocurrency</option>
                    <option value="BTC">Bitcoin (BTC)</option>
                    <option value="ETH">Ethereum (ETH)</option>
                    <option value="USDT">Tether (USDT)</option>
                    <option value="SOL">Solana (SOL)</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Amount <span class="required">*</span></label>
                <div class="amount-input">
                    <input type="number" id="transferAmount" placeholder="0.00000000">
                    <span id="transferCurrency">BTC</span>
                </div>
                <div class="balance-info">
                    <span>Balance: <span id="transferBalance">0.00000000 BTC</span></span>
                    <a href="#" onclick="setMaxTransferAmount(); return false;">Max</a>
                </div>
            </div>
            
            <div class="form-group">
                <label>Note (Optional)</label>
                <textarea id="transferNote" placeholder="Add a note to the recipient" rows="3"></textarea>
            </div>
            
            <div class="transfer-summary">
                <div class="summary-item">
                    <span>Network Fee:</span>
                    <span>0.0005 BTC</span>
                </div>
                <div class="summary-item total">
                    <span>Total:</span>
                    <span id="transferTotal">0.00050000 BTC</span>
                </div>
            </div>
            
            <button class="btn" onclick="executeTransfer()">Send Now</button>
        </div>
    </div>
    
    <div class="card">
        <h2 class="card-title">Transfer History</h2>
        <div class="transactions-table">
            <div class="table-header">
                <div class="table-cell">Date</div>
                <div class="table-cell">To</div>
                <div class="table-cell">Amount</div>
                <div class="table-cell">Status</div>
            </div>
            <div class="transfer-history" id="transferHistory">
                <div class="empty-state">
                    <i class="fas fa-exchange-alt"></i>
                    <p>No transfer history yet</p>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card">
        <div class="address-book">
            <div class="card-header">
                <h2 class="card-title">Address Book</h2>
                <button class="btn btn-secondary" onclick="showAddAddressModal()">
                    <i class="fas fa-plus"></i> Add Address
                </button>
            </div>
            
            <div class="address-list" id="addressList">
                <div class="empty-address-book">
                    <i class="fas fa-address-book"></i>
                    <p>No saved addresses yet</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Add Address Modal -->
<div id="addAddressModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Add to Address Book</h2>
            <span class="close" onclick="closeAddAddressModal()">&times;</span>
        </div>
        
        <div class="form-group">
            <label>Name</label>
            <input type="text" id="addressName" placeholder="Enter recipient name">
        </div>
        
        <div class="form-group">
            <label>Address or Email</label>
            <input type="text" id="addressValue" placeholder="Enter wallet address or email">
        </div>
        
        <div class="form-group">
            <label>Cryptocurrency</label>
            <select id="addressCrypto" class="form-select">
                <option value="BTC">Bitcoin (BTC)</option>
                <option value="ETH">Ethereum (ETH)</option>
                <option value="USDT">Tether (USDT)</option>
                <option value="SOL">Solana (SOL)</option>
            </select>
        </div>
        
        <button class="btn" onclick="saveAddress()">Save Address</button>
    </div>
</div>

                <!-- Buy Section -->
                <section id="buy" class="section" style="display: none;">
                    <div class="card">
                        <h2 class="card-title">Buy Cryptocurrency</h2>
                        <div class="buy-grid">
                            <div class="buy-options">
                                <div class="buy-option active" data-symbol="BTC">
                                    <i class="fab fa-bitcoin"></i>
                                    <span>Bitcoin</span>
                                </div>
                                <div class="buy-option" data-symbol="ETH">
                                    <i class="fab fa-ethereum"></i>
                                    <span>Ethereum</span>
                                </div>
                                <div class="buy-option" data-symbol="USDT">
                                    <i class="fas fa-dollar-sign"></i>
                                    <span>Tether</span>
                                </div>
                                <div class="buy-option" data-symbol="SOL">
                                    <i class="fas fa-circle"></i>
                                    <span>Solana</span>
                                </div>
                                <div class="buy-option" data-symbol="ADA">
                                    <i class="fas fa-circle"></i>
                                    <span>Cardano</span>
                                </div>
                            </div>
                            <div class="buy-form">
                                <div class="form-group">
                                    <label>Payment Method</label>
                                    <select class="form-select">
                                        <option>Bank Transfer</option>
                                        <option>Credit/Debit Card</option>
                                        <option>PayPal</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Amount (USD)</label>
                                    <div class="amount-input">
                                        <input type="number" id="buyAmount" placeholder="0.00" step="0.01" min="0">
                                        <span>USD</span>
                                    </div>
                                    <div class="amount-slider">
                                        <input type="range" min="10" max="10000" value="100" id="buyAmountSlider">
                                        <div class="slider-ticks">
                                            <span>$10</span>
                                            <span>$100</span>
                                            <span>$1K</span>
                                            <span>$10K</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="buy-summary">
                                    <div class="summary-item">
                                        <span>You'll receive:</span>
                                        <span id="buyReceiveAmount">0.00000000 BTC</span>
                                    </div>
                                    <div class="summary-item">
                                        <span>Fee (0.5%):</span>
                                        <span id="buyFeeAmount">$0.00</span>
                                    </div>
                                    <div class="summary-item total">
                                        <span>Total:</span>
                                        <span id="buyTotalAmount">$0.00</span>
                                    </div>
                                </div>
                                <button class="btn btn-buy">Buy Now</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Why buy with CryptoVault?</h2>
                        <div class="features-grid">
                            <div class="feature-item">
                                <i class="fas fa-bolt"></i>
                                <h3>Instant Execution</h3>
                                <p>Your orders are executed at the best available market price instantly.</p>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-lock"></i>
                                <h3>Secure Storage</h3>
                                <p>Your purchased crypto is stored securely in our insured wallets.</p>
                            </div>
                            <div class="feature-item">
                                <i class="fas fa-percentage"></i>
                                <h3>Low Fees</h3>
                                <p>Enjoy some of the lowest trading fees in the industry.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Sell Section -->
                <section id="sell" class="section" style="display: none;">
                    <div class="card">
                        <h2 class="card-title">Sell Cryptocurrency</h2>
                        <div class="sell-grid">
                            <div class="sell-options">
                                <div class="sell-option active" data-symbol="BTC">
                                    <i class="fab fa-bitcoin"></i>
                                    <span>Bitcoin</span>
                                    <span class="option-balance">0.00000000 BTC</span>
                                </div>
                                <div class="sell-option" data-symbol="ETH">
                                    <i class="fab fa-ethereum"></i>
                                    <span>Ethereum</span>
                                    <span class="option-balance">0.00000000 ETH</span>
                                </div>
                                <div class="sell-option" data-symbol="SOL">
                                    <i class="fas fa-circle"></i>
                                    <span>Solana</span>
                                    <span class="option-balance">0.00000000 SOL</span>
                                </div>
                            </div>
                            <div class="sell-form">
                                <div class="form-group">
                                    <label>Sell Amount</label>
                                    <div class="amount-toggle">
                                        <button class="toggle-btn active">USD</button>
                                        <button class="toggle-btn">Crypto</button>
                                    </div>
                                    <div class="amount-input">
                                        <input type="number" id="sellAmount" placeholder="0.00" step="0.01" min="0">
                                        <span>USD</span>
                                    </div>
                                    <div class="amount-slider">
                                        <input type="range" min="0" max="100" value="0" id="sellAmountSlider">
                                        <div class="slider-percent">
                                            <span>0%</span>
                                            <span>25%</span>
                                            <span>50%</span>
                                            <span>75%</span>
                                            <span>100%</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Withdrawal Method</label>
                                    <select class="form-select">
                                        <option>Bank Transfer</option>
                                        <option>PayPal</option>
                                    </select>
                                </div>
                                <div class="sell-summary">
                                    <div class="summary-item">
                                        <span>You'll receive:</span>
                                        <span id="sellReceiveAmount">$0.00</span>
                                    </div>
                                    <div class="summary-item">
                                        <span>Fee (0.5%):</span>
                                        <span id="sellFeeAmount">$0.00</span>
                                    </div>
                                    <div class="summary-item total">
                                        <span>Net Amount:</span>
                                        <span id="sellNetAmount">$0.00</span>
                                    </div>
                                </div>
                                <button class="btn btn-sell">Sell Now</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Sell History</h2>
                        <div class="transactions-table">
                            <div class="table-header">
                                <div class="table-cell">Date</div>
                                <div class="table-cell">Asset</div>
                                <div class="table-cell">Amount</div>
                                <div class="table-cell">Status</div>
                            </div>
                            <div class="empty-state">
                                <i class="fas fa-exchange-alt"></i>
                                <p>No sell transactions yet</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Convert Section -->
                <section id="convert" class="section" style="display: none;">
                    <div class="card">
                        <h2 class="card-title">Convert Cryptocurrency</h2>
                        <div class="convert-form">
                            <div class="convert-from">
                                <div class="form-group">
                                    <label>From</label>
                                    <div class="crypto-select">
                                        <div class="selected-option">
                                            <i class="fab fa-bitcoin"></i>
                                            <span>Bitcoin (BTC)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                    </div>
                                    <div class="amount-input">
                                        <input type="number" placeholder="0.00000000">
                                        <span>BTC</span>
                                    </div>
                                    <div class="balance-info">
                                        <span>Balance: 0.00000000 BTC</span>
                                        <a href="#">Max</a>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="convert-swap">
                                <button class="swap-btn">
                                    <i class="fas fa-exchange-alt"></i>
                                </button>
                            </div>
                            
                            <div class="convert-to">
                                <div class="form-group">
                                    <label>To</label>
                                    <div class="crypto-select">
                                        <div class="selected-option">
                                            <i class="fab fa-ethereum"></i>
                                            <span>Ethereum (ETH)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                    </div>
                                    <div class="amount-input">
                                        <input type="number" placeholder="0.00000000">
                                        <span>ETH</span>
                                    </div>
                                    <div class="balance-info">
                                        <span>1 BTC â 14.2857 ETH</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="convert-summary">
                                <div class="summary-item">
                                    <span>Exchange Rate:</span>
                                    <span>1 BTC = 14.2857 ETH</span>
                                </div>
                                <div class="summary-item">
                                    <span>Fee:</span>
                                    <span>0.1%</span>
                                </div>
                                <div class="summary-item">
                                    <span>Estimated Time:</span>
                                    <span>Instant</span>
                                </div>
                            </div>
                            
                            <button class="btn btn-convert">Convert Now</button>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Conversion History</h2>
                        <div class="transactions-table">
                            <div class="table-header">
                                <div class="table-cell">Date</div>
                                <div class="table-cell">From</div>
                                <div class="table-cell">To</div>
                                <div class="table-cell">Amount</div>
                            </div>
                            <div class="empty-state">
                                <i class="fas fa-exchange-alt"></i>
                                <p>No conversion history yet</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Deposit Section -->
                <section id="deposit" class="section" style="display: none;">
                    <div class="card">
                        <h2 class="card-title">Deposit Funds</h2>
                        <div class="deposit-methods">
                            <div class="method-tabs">
                                <button class="method-tab active" data-method="bank">
                                    <i class="fas fa-university"></i>
                                    <span>Bank Transfer</span>
                                </button>
                                <button class="method-tab" data-method="card">
                                    <i class="fas fa-credit-card"></i>
                                    <span>Credit/Debit Card</span>
                                </button>
                                <button class="method-tab" data-method="paypal">
                                    <i class="fab fa-paypal"></i>
                                    <span>PayPal</span>
                                </button>
                            </div>
                            
                            <div class="method-content active" id="bankMethod">
                                <div class="form-group">
                                    <label>Amount (USD)</label>
                                    <div class="amount-input">
                                        <input type="number" placeholder="0.00" step="0.01" min="10">
                                        <span>USD</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Bank Name</label>
                                    <input type="text" placeholder="Enter bank name">
                                </div>
                                <div class="form-group">
                                    <label>Account Number</label>
                                    <input type="text" placeholder="Enter account number">
                                </div>
                                <div class="form-group">
                                    <label>Routing Number</label>
                                    <input type="text" placeholder="Enter routing number">
                                </div>
                                <button class="btn btn-deposit">Initiate Transfer</button>
                                <div class="deposit-info">
                                    <p><i class="fas fa-info-circle"></i> Bank transfers typically take 1-3 business days to complete.</p>
                                </div>
                            </div>
                            
                            <div class="method-content" id="cardMethod">
                                <div class="form-group">
                                    <label>Amount (USD)</label>
                                    <div class="amount-input">
                                        <input type="number" placeholder="0.00" step="0.01" min="10">
                                        <span>USD</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Card Number</label>
                                    <input type="text" placeholder="1234 5678 9012 3456">
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Expiry Date</label>
                                        <input type="text" placeholder="MM/YY">
                                    </div>
                                    <div class="form-group">
                                        <label>CVV</label>
                                        <input type="text" placeholder="123">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Cardholder Name</label>
                                    <input type="text" placeholder="Name on card">
                                </div>
                                <button class="btn btn-deposit">Deposit Now</button>
                                <div class="deposit-info">
                                    <p><i class="fas fa-lock"></i> Your payment is securely processed by our PCI-compliant provider.</p>
                                </div>
                            </div>
                            
                            <div class="method-content" id="paypalMethod">
                                <div class="form-group">
                                    <label>Amount (USD)</label>
                                    <div class="amount-input">
                                        <input type="number" placeholder="0.00" step="0.01" min="10">
                                        <span>USD</span>
                                    </div>
                                </div>
                                <div class="paypal-info">
                                    <p>You'll be redirected to PayPal to complete your deposit.</p>
                                    <p>Minimum deposit: $10.00</p>
                                </div>
                                <button class="btn btn-paypal">
                                    <i class="fab fa-paypal"></i>
                                    <span>Continue with PayPal</span>
                                </button>
                            </div>
                            
                            <div class="method-content" id="mobileMethod">
                                <div class="form-group">
                                    <label>Amount (USD)</label>
                                    <div class="amount-input">
                                        <input type="number" placeholder="0.00" step="0.01" min="10">
                                        <span>USD</span>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>Mobile Network</label>
                                    <select class="form-select">
                                        <option>MTN</option>
                                        <option>Airtel</option>
                                        <option>Vodafone</option>
                                        <option>Tigo</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Mobile Number</label>
                                    <input type="text" placeholder="Enter mobile number">
                                </div>
                                <button class="btn btn-deposit">Deposit Now</button>
                                <div class="deposit-info">
                                    <p><i class="fas fa-info-circle"></i> You'll receive a prompt on your mobile device to confirm the payment.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="card">
                        <h2 class="card-title">Recent Deposits</h2>
                        <div class="transactions-table">
                            <div class="table-header">
                                <div class="table-cell">Date</div>
                                <div class="table-cell">Method</div>
                                <div class="table-cell">Amount</div>
                                <div class="table-cell">Status</div>
                            </div>
                            <div class="empty-state">
                                <i class="fas fa-hand-holding-usd"></i>
                                <p>No deposit history yet</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings" class="section" style="display: none;">
                    <div class="card">
                        <h2 class="card-title">Account Settings</h2>
                        <div class="settings-tabs">
                            <button class="settings-tab active" data-tab="profile">Profile</button>
                            <button class="settings-tab" data-tab="security">Security</button>
                            <button class="settings-tab" data-tab="notifications">Notifications</button>
                            <button class="settings-tab" data-tab="preferences">Preferences</button>
                        </div>
                        
                        <div class="settings-content active" id="profileTab">
                            <div class="profile-header">
                                <div class="avatar-large">
                                    <i class="fas fa-user"></i>
                                </div>
                                <div class="profile-info">
                                    <h3 id="userProfileName">Demo User</h3>
                                    <p id="userProfileEmail">demo@cryptovault.com</p>
                                </div>
                                <button class="btn btn-secondary">Change Photo</button>
                            </div>
                            
                            <form class="profile-form">
                                <div class="form-group">
                                    <label>Full Name</label>
                                    <input type="text" value="Demo User">
                                </div>
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" value="demo@cryptovault.com">
                                </div>
                                <div class="form-group">
                                    <label>Phone Number</label>
                                    <input type="tel" placeholder="+1 (___) ___-____">
                                </div>
                                <div class="form-group">
                                    <label>Country</label>
                                    <select>
                                        <option>United States</option>
                                        <option>United Kingdom</option>
                                        <option>Canada</option>
                                        <option>Australia</option>
                                    </select>
                                </div>
                                <button class="btn">Save Changes</button>
                            </form>
                        </div>
                        
                        <div class="settings-content" id="securityTab">
                            <div class="security-item">
                                <div class="security-info">
                                    <h3>Password</h3>
                                    <p>Last changed 3 months ago</p>
                                </div>
                                <button class="btn btn-secondary">Change Password</button>
                            </div>
                            
                            <div class="security-item">
                                <div class="security-info">
                                    <h3>Two-Factor Authentication</h3>
                                    <p>Add an extra layer of security to your account</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="security-item">
                                <div class="security-info">
                                    <h3>Device Management</h3>
                                    <p>View and manage devices that have accessed your account</p>
                                </div>
                                <button class="btn btn-secondary">Manage Devices</button>
                            </div>
                            
                            <div class="security-item">
                                <div class="security-info">
                                    <h3>Login History</h3>
                                    <p>Review recent login activity on your account</p>
                                </div>
                                <button class="btn btn-secondary">View History</button>
                            </div>
                        </div>
                        
                        <div class="settings-content" id="notificationsTab">
                            <div class="notification-item">
                                <div class="notification-info">
                                    <h3>Email Notifications</h3>
                                    <p>Receive important account notifications via email</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="notification-item">
                                <div class="notification-info">
                                    <h3>Push Notifications</h3>
                                    <p>Get real-time alerts on your mobile device</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="notification-item">
                                <div class="notification-info">
                                    <h3>Price Alerts</h3>
                                    <p>Be notified when your watched assets reach target prices</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            
                            <div class="notification-item">
                                <div class="notification-info">
                                    <h3>Newsletter</h3>
                                    <p>Receive weekly market updates and platform news</p>
                                </div>
                                <label class="switch">
                                    <input type="checkbox" checked>
                                    <span class="slider round"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="settings-content" id="preferencesTab">
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h3>Language</h3>
                                    <p>Select your preferred language</p>
                                </div>
                                <select class="form-select">
                                    <option>English</option>
                                    <option>Spanish</option>
                                    <option>French</option>
                                    <option>German</option>
                                </select>
                            </div>
                            
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h3>Currency</h3>
                                    <p>Default currency for your account</p>
                                </div>
                                <select class="form-select">
                                    <option>US Dollar (USD)</option>
                                    <option>Euro (EUR)</option>
                                    <option>British Pound (GBP)</option>
                                    <option>Japanese Yen (JPY)</option>
                                </select>
                            </div>
                            
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h3>Theme</h3>
                                    <p>Light or dark mode</p>
                                </div>
                                <div class="theme-toggle">
                                    <button class="theme-option" data-theme="light">
                                        <i class="fas fa-sun"></i>
                                        <span>Light</span>
                                    </button>
                                    <button class="theme-option active" data-theme="dark">
                                        <i class="fas fa-moon"></i>
                                        <span>Dark</span>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="preference-item">
                                <div class="preference-info">
                                    <h3>Time Format</h3>
                                    <p>12-hour or 24-hour clock</p>
                                </div>
                                <div class="time-format-toggle">
                                    <button class="format-option active">12-hour</button>
                                    <button class="format-option">24-hour</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Trading Modal -->
    <div id="tradeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="tradeModalTitle">Trade Bitcoin</h2>
                <span class="close" onclick="closeTradeModal()">&times;</span>
            </div>
            
            <div class="trade-buttons">
                <button class="trade-btn active" id="buyBtn" onclick="setTradeType('buy')">Buy</button>
                <button class="trade-btn" id="sellBtn" onclick="setTradeType('sell')">Sell</button>
            </div>
            
            <div class="form-group">
                <label>Amount (USD)</label>
                <div class="amount-input">
                    <input type="number" id="tradeAmount" placeholder="0.00" step="0.01" min="0">
                    <span>USD</span>
                </div>
            </div>
            
            <div class="quick-amounts">
                <button class="quick-amount" onclick="setQuickAmount(100)">$100</button>
                <button class="quick-amount" onclick="setQuickAmount(500)">$500</button>
                <button class="quick-amount" onclick="setQuickAmount(1000)">$1000</button>
                <button class="quick-amount" onclick="setQuickAmount('max')">Max</button>
            </div>
            
            <div class="trade-summary">
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Price per coin:</span>
                    <span id="tradePricePerCoin">$0.00</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                    <span>Quantity:</span>
                    <span id="tradeQuantity">0.00000000</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Total:</span>
                    <span id="tradeTotal">$0.00</span>
                </div>
            </div>
            
            <button class="btn" onclick="executeTrade()" id="executeTradeBtn">Buy Now</button>
        </div>
    </div>

    <script>
        // Application State
        let currentUser = null;
        let userPortfolio = {
            balance: 10000.00,
            holdings: {},
            totalInvested: 0,
            transactions: []
        };

        let currentTradeType = 'buy';
        let selectedCrypto = null;
        let sidebarCollapsed = false;
        let darkMode = true;
        let lastActiveSection = 'dashboard';

        // Cryptocurrency data with simulated prices
        const cryptocurrencies = {
            'BTC': {
                name: 'Bitcoin',
                symbol: 'BTC',
                price: 0, // Will be updated from API
                change24h: 0,
                color: '#f7931a',
                icon: 'â¿'
            },
            'ETH': {
                name: 'Ethereum',
                symbol: 'ETH',
                price: 0,
                change24h: 0,
                color: '#627eea',
                icon: 'Î'
            },
            'ADA': {
                name: 'Cardano',
                symbol: 'ADA',
                price: 0,
                change24h: 0,
                color: '#0033ad',
                icon: 'â³'
            },
            'DOT': {
                name: 'Polkadot',
                symbol: 'DOT',
                price: 0,
                change24h: 0,
                color: '#e6007a',
                icon: 'â'
            },
            'LINK': {
                name: 'Chainlink',
                symbol: 'LINK',
                price: 0,
                change24h: 0,
                color: '#375bd2',
                icon: 'â¬¢'
            },
            'SOL': {
                name: 'Solana',
                symbol: 'SOL',
                price: 0,
                change24h: 0,
                color: '#14f195',
                icon: 'â'
            },
            'USDT': {
                name: 'Tether',
                symbol: 'USDT',
                price: 1.00,
                change24h: 0,
                color: '#26a17b',
                icon: '$'
            }
        };

        // DOM Elements
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');
        const mobileSidebarToggle = document.getElementById('mobileSidebarToggle');
        const themeToggle = document.getElementById('themeToggle');
        const pageTitle = document.getElementById('pageTitle');
        const landingBtcPrice = document.getElementById('landingBtcPrice');
        const landingBtcChange = document.getElementById('landingBtcChange');
        const currentBtcPrice = document.getElementById('currentBtcPrice');
        const btcChange24h = document.getElementById('btcChange24h');

        // Initialize the application
        function initApp() {
            // Set up event listeners
            setupEventListeners();
            
            // Fetch real Bitcoin price
            fetchBitcoinPrice();

            checkSavedSession();
            
            // Load demo data if needed
            // loadDemoData();
            
            // Check for saved user preference
            checkSavedPreferences();
        }

        // Set up event listeners
        function setupEventListeners() {
            // Sidebar toggle
            sidebarToggle.addEventListener('click', toggleSidebar);
            mobileSidebarToggle.addEventListener('click', toggleMobileSidebar);
            
            // Theme toggle
            themeToggle.addEventListener('click', toggleTheme);
            
            // Form validation
            document.getElementById('loginEmail').addEventListener('blur', validateEmail);
            document.getElementById('loginPassword').addEventListener('blur', validatePassword);
            document.getElementById('regName').addEventListener('blur', validateName);
            document.getElementById('regEmail').addEventListener('blur', validateRegEmail);
            document.getElementById('regPassword').addEventListener('blur', validateRegPassword);
            document.getElementById('regConfirmPassword').addEventListener('blur', validateConfirmPassword);
            
            // Trading modal
            document.getElementById('tradeAmount').addEventListener('input', updateTradeSummary);
            document.getElementById('tradeAmount').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') executeTrade();
            });
            
            // Close modal when clicking outside
            document.getElementById('tradeModal').addEventListener('click', function(e) {
                if (e.target === this) closeTradeModal();
            });
            
            // Buy section interactions
            document.querySelectorAll('.buy-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.buy-option').forEach(opt => opt.classList.remove('active'));
                    this.classList.add('active');
                    updateBuyForm(this.dataset.symbol);
                });
            });
            
            document.getElementById('buyAmount').addEventListener('input', updateBuySummary);
            document.getElementById('buyAmountSlider').addEventListener('input', function() {
                document.getElementById('buyAmount').value = this.value;
                updateBuySummary();
            });
            
            // Deposit method tabs
            document.querySelectorAll('.method-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const method = this.dataset.method;
                    document.querySelectorAll('.method-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.method-content').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById(method + 'Method').classList.add('active');
                });
            });
            
            // Settings tabs
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab + 'Tab';
                    document.querySelectorAll('.settings-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.settings-content').forEach(c => c.classList.remove('active'));
                    this.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // Toggle sidebar collapse
        function toggleSidebar() {
            sidebarCollapsed = !sidebarCollapsed;
            sidebar.classList.toggle('collapsed');
            sidebarToggle.innerHTML = sidebarCollapsed ? 
                '<i class="fas fa-chevron-right"></i>' : 
                '<i class="fas fa-chevron-left"></i>';
            
            // Save preference to localStorage
            localStorage.setItem('sidebarCollapsed', sidebarCollapsed);
        }

        // Toggle mobile sidebar
        function toggleMobileSidebar() {
            sidebar.classList.toggle('mobile-visible');
        }

        // Toggle dark/light theme
        function toggleTheme() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode');
            document.body.classList.toggle('light-mode');
            
            // Update icon and text
            const icon = themeToggle.querySelector('i');
            const text = themeToggle.querySelector('span');
            if (darkMode) {
                icon.className = 'fas fa-moon';
                text.textContent = 'Dark Mode';
            } else {
                icon.className = 'fas fa-sun';
                text.textContent = 'Light Mode';
            }
            
            // Save preference to localStorage
            localStorage.setItem('darkMode', darkMode);
        }

        // Check for saved preferences
        function checkSavedPreferences() {
            // Check for sidebar preference
            const savedSidebarState = localStorage.getItem('sidebarCollapsed');
            if (savedSidebarState === 'true') {
                sidebarCollapsed = true;
                sidebar.classList.add('collapsed');
                sidebarToggle.innerHTML = '<i class="fas fa-chevron-right"></i>';
            }
            
            // Check for theme preference
            const savedTheme = localStorage.getItem('darkMode');
            if (savedTheme === 'false') {
                darkMode = false;
                document.body.classList.remove('dark-mode');
                document.body.classList.add('light-mode');
                const icon = themeToggle.querySelector('i');
                const text = themeToggle.querySelector('span');
                icon.className = 'fas fa-sun';
                text.textContent = 'Light Mode';
            }
        }
        function updateTransferForm() {
    const cryptoSelect = document.getElementById('transferCrypto');
    const currencySpan = document.getElementById('transferCurrency');
    const balanceSpan = document.getElementById('transferBalance');
    
    cryptoSelect.addEventListener('change', function() {
        const symbol = this.value;
        currencySpan.textContent = symbol;
        
        // Update balance display
        const holding = userPortfolio.holdings[symbol] || { quantity: 0 };
        balanceSpan.textContent = `${holding.quantity.toFixed(8)} ${symbol}`;
    });
}

function setMaxTransferAmount() {
    const symbol = document.getElementById('transferCrypto').value;
    if (!symbol) return;
    
    const holding = userPortfolio.holdings[symbol];
    if (holding) {
        document.getElementById('transferAmount').value = holding.quantity.toFixed(8);
    }
}

function updateTransferHistory() {
    const historyContainer = document.getElementById('transferHistory');
    const transferTransactions = userPortfolio.transactions.filter(tx => tx.type === 'transfer');
    
    if (transferTransactions.length === 0) {
        historyContainer.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-exchange-alt"></i>
                <p>No transfer history yet</p>
            </div>
        `;
        return;
    }
    
    historyContainer.innerHTML = '';
    
    transferTransactions.reverse().forEach(tx => {
        const txElement = document.createElement('div');
        txElement.className = 'table-row';
        txElement.innerHTML = `
            <div class="table-cell">${new Date(tx.timestamp).toLocaleString()}</div>
            <div class="table-cell">${tx.recipient}</div>
            <div class="table-cell">${tx.quantity} ${tx.symbol}</div>
            <div class="table-cell completed">Completed</div>
        `;
        historyContainer.appendChild(txElement);
    });
}

// Address book functions
let addressBook = [
    { name: 'John Doe', address: '0x71C7656EC7ab88b098defB751B7401B5f6d8976F', crypto: 'ETH' },
    { name: 'Alice Smith', address: 'bc1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq', crypto: 'BTC' }
];

function showAddAddressModal() {
    document.getElementById('addAddressModal').style.display = 'block';
}

function closeAddAddressModal() {
    document.getElementById('addAddressModal').style.display = 'none';
}

function saveAddress() {
    const name = document.getElementById('addressName').value;
    const address = document.getElementById('addressValue').value;
    const crypto = document.getElementById('addressCrypto').value;
    
    if (!name || !address || !crypto) {
        alert('Please fill in all fields');
        return;
    }
    
    addressBook.push({ name, address, crypto });
    updateAddressBook();
    closeAddAddressModal();
}

function updateAddressBook() {
    const addressList = document.getElementById('addressList');
    
    if (addressBook.length === 0) {
        addressList.innerHTML = `
            <div class="empty-address-book">
                <i class="fas fa-address-book"></i>
                <p>No saved addresses yet</p>
            </div>
        `;
        return;
    }
    
    addressList.innerHTML = '';
    
    addressBook.forEach((address, index) => {
        const addressElement = document.createElement('div');
        addressElement.className = 'address-item';
        addressElement.innerHTML = `
            <div class="address-info">
                <h4>${address.name}</h4>
                <p>${address.address}</p>
                <span class="crypto-badge">${address.crypto}</span>
            </div>
            <div class="address-actions">
                <button onclick="useAddress(${index})"><i class="fas fa-paper-plane"></i></button>
                <button onclick="deleteAddress(${index})"><i class="fas fa-trash"></i></button>
            </div>
        `;
        addressList.appendChild(addressElement);
    });
}

function useAddress(index) {
    const address = addressBook[index];
    document.getElementById('transferRecipient').value = address.address;
    document.getElementById('transferCrypto').value = address.crypto;
    showSection('transfer');
}

function deleteAddress(index) {
    if (confirm('Are you sure you want to delete this address?')) {
        addressBook.splice(index, 1);
        updateAddressBook();
    }
}

// Initialize transfer functionality
function initializeTransfer() {
    updateTransferForm();
    updateTransferHistory();
    updateAddressBook();
}

// Add this to your initializeApp function
function initializeApp() {
    // Existing initialization...
    initializeTransfer();
}

        // Fetch real Bitcoin price from CoinGecko API
        function fetchBitcoinPrice() {
            fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,cardano,polkadot,chainlink,solana,tether&vs_currencies=usd&include_24hr_change=true')
                .then(response => response.json())
                .then(data => {
                    // Update Bitcoin price
                    const btcPrice = data.bitcoin.usd;
                    const btcChange = data.bitcoin.usd_24h_change;
                    
                    cryptocurrencies.BTC.price = btcPrice;
                    cryptocurrencies.BTC.change24h = btcChange;
                    cryptocurrencies.ETH.price = data.ethereum.usd;
                    cryptocurrencies.ETH.change24h = data.ethereum.usd_24h_change;
                    cryptocurrencies.ADA.price = data.cardano.usd;
                    cryptocurrencies.ADA.change24h = data.cardano.usd_24h_change;
                    cryptocurrencies.DOT.price = data.polkadot.usd;
                    cryptocurrencies.DOT.change24h = data.polkadot.usd_24h_change;
                    cryptocurrencies.LINK.price = data.chainlink.usd;
                    cryptocurrencies.LINK.change24h = data.chainlink.usd_24h_change;
                    cryptocurrencies.SOL.price = data.solana.usd;
                    cryptocurrencies.SOL.change24h = data.solana.usd_24h_change;
                    
                    // Update UI
                    landingBtcPrice.textContent = btcPrice.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                    currentBtcPrice.textContent = btcPrice.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                    
                    // Update change percentage
                    updateChangePercentage(btcChange, landingBtcChange);
                    updateChangePercentage(btcChange, btcChange24h);
                    
                    // Initialize app if user is logged in
                    if (currentUser) {
                        initializeApp();
                    }
                })
                .catch(error => {
                    console.error('Error fetching Bitcoin price:', error);
                    
                    // Fallback to simulated prices if API fails
                    cryptocurrencies.BTC.price = 45250.00;
                    cryptocurrencies.BTC.change24h = 2.45;
                    cryptocurrencies.ETH.price = 3150.00;
                    cryptocurrencies.ETH.change24h = -1.23;
                    cryptocurrencies.ADA.price = 1.25;
                    cryptocurrencies.ADA.change24h = 4.67;
                    cryptocurrencies.DOT.price = 22.50;
                    cryptocurrencies.DOT.change24h = -3.12;
                    cryptocurrencies.LINK.price = 28.75;
                    cryptocurrencies.LINK.change24h = 5.89;
                    cryptocurrencies.SOL.price = 145.30;
                    cryptocurrencies.SOL.change24h = 7.23;
                    
                    landingBtcPrice.textContent = '$45,250.00';
                    currentBtcPrice.textContent = '$45,250.00';
                    landingBtcChange.textContent = '+2.45%';
                    btcChange24h.textContent = '+2.45%';
                    
                    if (currentUser) {
                        initializeApp();
                    }
                });
        }

        // Update change percentage display
        function updateChangePercentage(change, element) {
            if (change >= 0) {
                element.textContent = `+${change.toFixed(2)}%`;
                element.className = 'positive';
            } else {
                element.textContent = `${change.toFixed(2)}%`;
                element.className = 'negative';
            }
        }

        // Authentication Functions
        function showAuthScreen() {
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('authScreen').style.display = 'flex';
        }

        function showRegister() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
        }

        function showLogin() {
            document.getElementById('registerForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }

        // Form validation functions
        function validateEmail() {
            const email = document.getElementById('loginEmail').value;
            const errorElement = document.getElementById('loginEmailError');
            
            if (!email) {
                errorElement.textContent = 'Email is required';
                return false;
            }
            
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                errorElement.textContent = 'Please enter a valid email';
                return false;
            }
            
            errorElement.textContent = '';
            return true;
        }

        function validatePassword() {
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginPasswordError');
            
            if (!password) {
                errorElement.textContent = 'Password is required';
                return false;
            }
            
            errorElement.textContent = '';
            return true;
        }

        function validateName() {
            const name = document.getElementById('regName').value;
            const errorElement = document.getElementById('regNameError');
            
            if (!name) {
                errorElement.textContent = 'Full name is required';
                return false;
            }
            
            errorElement.textContent = '';
            return true;
        }

        function validateRegEmail() {
            const email = document.getElementById('regEmail').value;
            const errorElement = document.getElementById('regEmailError');
            
            if (!email) {
                errorElement.textContent = 'Email is required';
                return false;
            }
            
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                errorElement.textContent = 'Please enter a valid email';
                return false;
            }
            
            errorElement.textContent = '';
            return true;
        }

        function validateRegPassword() {
            const password = document.getElementById('regPassword').value;
            const errorElement = document.getElementById('regPasswordError');
            
            if (!password) {
                errorElement.textContent = 'Password is required';
                return false;
            }
            
            if (password.length < 8) {
                errorElement.textContent = 'Password must be at least 8 characters';
                return false;
            }
            
            errorElement.textContent = '';
            return true;
        }

        function validateConfirmPassword() {
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            const errorElement = document.getElementById('regConfirmPasswordError');
            
            if (!confirmPassword) {
                errorElement.textContent = 'Please confirm your password';
                return false;
            }
            
            if (password !== confirmPassword) {
                errorElement.textContent = 'Passwords do not match';
                return false;
            }
            
            errorElement.textContent = '';
            return true;
        }

        function validateLogin() {
            const isEmailValid = validateEmail();
            const isPasswordValid = validatePassword();
            
            if (isEmailValid && isPasswordValid) {
                login();
            }
        }

        function validateRegister() {
            const isNameValid = validateName();
            const isEmailValid = validateRegEmail();
            const isPasswordValid = validateRegPassword();
            const isConfirmValid = validateConfirmPassword();
            const isTermsAccepted = document.getElementById('acceptTerms').checked;
            
            if (!isTermsAccepted) {
                alert('You must accept the terms and conditions');
                return;
            }
            
            if (isNameValid && isEmailValid && isPasswordValid && isConfirmValid) {
                register();
            }
        }

        function register() {
            const name = document.getElementById('regName').value;
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;

            // Simulate registration
            currentUser = { 
                name, 
                email,
                avatar: `https://ui-avatars.com/api/?name=${encodeURIComponent(name)}&background=random`
            };
            showMainApp();
        }

        function checkSavedSession() {
    const savedUser = localStorage.getItem('cryptoVaultUser');
    const savedSection = localStorage.getItem('lastActiveSection');
    
    if (savedUser) {
        try {
            currentUser = JSON.parse(savedUser);
            showMainApp();
            
            if (savedSection) {
                lastActiveSection = savedSection;
                showSection(savedSection);
            }
        } catch (e) {
            console.error('Error parsing saved user data', e);
            localStorage.removeItem('cryptoVaultUser');
        }
    }
}

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            // Simulate login
            currentUser = { 
                name: 'Demo User', 
                email,
                avatar: 'https://randomuser.me/api/portraits/men/1.jpg'
            };
               // Save user session
    localStorage.setItem('cryptoVaultUser', JSON.stringify({
        name: currentUser.name,
        email: currentUser.email,
        avatar: currentUser.avatar
    }));
            showMainApp();
        }

        function logout() {
           currentUser = null;
    localStorage.removeItem('cryptoVaultUser');
    localStorage.removeItem('lastActiveSection');
    document.getElementById('landingPage').style.display = 'block';
    document.getElementById('authScreen').style.display = 'none';
    document.getElementById('mainApp').style.display = 'none';
        }

        function showMainApp() {
            document.getElementById('landingPage').style.display = 'none';
            document.getElementById('authScreen').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            
            // Update user info in sidebar
            if (currentUser) {
                document.getElementById('sidebarUserName').textContent = currentUser.name;
                document.getElementById('sidebarUserEmail').textContent = currentUser.email;
                
                const avatar = document.querySelector('.avatar');
                if (currentUser.avatar) {
                    avatar.innerHTML = `<img src="${currentUser.avatar}" alt="${currentUser.name}">`;
                }
                
                const largeAvatar = document.querySelector('.avatar-large');
                if (largeAvatar && currentUser.avatar) {
                    largeAvatar.innerHTML = `<img src="${currentUser.avatar}" alt="${currentUser.name}">`;
                }
            }
            
            initializeApp();
        }

        // App Initialization
        function initializeApp() {
            updatePortfolioDisplay();
            renderCryptoList();
            createPortfolioChart();
            createAllocationChart();
            simulatePriceUpdates();
        }

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show selected section
              document.getElementById(sectionName).style.display = 'block';
            lastActiveSection = sectionName;
            localStorage.setItem('lastActiveSection', sectionName);
            
            // Update page title
            const titles = {
                'dashboard': 'Dashboard',
                'portfolio': 'Portfolio',
                'markets': 'Markets',
                'buy': 'Buy Crypto',
                'sell': 'Sell Crypto',
                'convert': 'Convert',
                'deposit': 'Deposit',
                'settings': 'Settings'
            };
            pageTitle.textContent = titles[sectionName] || 'Dashboard';
            
            // Update sidebar menu items
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const menuItems = {
                'dashboard': 0,
                'portfolio': 1,
                'markets': 2,
                'buy': 3,
                'sell': 4,
                'convert': 5,
                'deposit': 6,
                'settings': 7
            };
            
            const index = menuItems[sectionName];
            if (index !== undefined) {
                document.querySelectorAll('.menu-item')[index].classList.add('active');
            }
            
            // Update content based on section
            if (sectionName === 'portfolio') {
                updatePortfolioHoldings();
            } else if (sectionName === 'markets' || sectionName === 'trade') {
                renderAllMarkets(sectionName);
            } else if (sectionName === 'buy') {
                updateBuyForm('BTC');
            }
            
            // Close mobile sidebar if open
            sidebar.classList.remove('mobile-visible');
        }

        // Portfolio Management
        function updatePortfolioDisplay() {
            document.getElementById('userBalance').textContent = userPortfolio.balance.toFixed(2);
            document.getElementById('availableBalance').textContent = userPortfolio.balance.toFixed(2);
            document.getElementById('totalInvested').textContent = userPortfolio.totalInvested.toFixed(2);
            
            const totalValue = userPortfolio.balance + calculateHoldingsValue();
            document.getElementById('portfolioValue').textContent = totalValue.toFixed(2);
            
            const holdingsCount = Object.keys(userPortfolio.holdings).length;
            document.getElementById('holdingsCount').textContent = `${holdingsCount} asset${holdingsCount !== 1 ? 's' : ''}`;
            
            updatePortfolioChange();
        }
        // Add this new transfer function
function executeTransfer() {
    const recipient = document.getElementById('transferRecipient').value;
    const amount = parseFloat(document.getElementById('transferAmount').value);
    const selectedCrypto = document.getElementById('transferCrypto').value;
    const note = document.getElementById('transferNote').value;

    if (!recipient || !amount || amount <= 0 || !selectedCrypto) {
        alert('Please fill in all required fields with valid values');
        return;
    }

    const crypto = cryptocurrencies[selectedCrypto];
    if (!crypto) {
        alert('Invalid cryptocurrency selected');
        return;
    }

    const holding = userPortfolio.holdings[selectedCrypto];
    if (!holding || holding.quantity < amount) {
        alert(`Insufficient ${selectedCrypto} balance`);
        return;
    }

    // Execute transfer
    holding.quantity -= amount;
    
    // Add transaction
    userPortfolio.transactions.push({
        type: 'transfer',
        symbol: selectedCrypto,
        quantity: amount,
        recipient: recipient,
        note: note,
        timestamp: new Date()
    });

    alert(`Successfully transferred ${amount} ${selectedCrypto} to ${recipient}`);
    updatePortfolioDisplay();
    updateTransferHistory();
}

        function calculateHoldingsValue() {
            let totalValue = 0;
            for (const [symbol, holding] of Object.entries(userPortfolio.holdings)) {
                if (cryptocurrencies[symbol]) {
                    totalValue += holding.quantity * cryptocurrencies[symbol].price;
                }
            }
            return totalValue;
        }

        function updatePortfolioChange() {
            const totalValue = userPortfolio.balance + calculateHoldingsValue();
            const initialValue = 10000; // Starting balance
            const change = totalValue - initialValue;
            const changePercent = (change / initialValue) * 100;
            
            const changeElement = document.getElementById('portfolioChange');
            const dayChangeElement = document.getElementById('dayChange');
            
            const changeText = `${change >= 0 ? '+' : ''}$${Math.abs(change).toFixed(2)} (${changePercent.toFixed(2)}%)`;
            changeElement.textContent = changeText;
            changeElement.className = change >= 0 ? 'positive' : 'negative';
            
            dayChangeElement.textContent = `${changePercent >= 0 ? '+' : ''}${changePercent.toFixed(2)}%`;
            dayChangeElement.className = changePercent >= 0 ? 'positive' : 'negative';
        }

        function updatePortfolioHoldings() {
            const grid = document.getElementById('holdingsGrid');
            
            if (Object.keys(userPortfolio.holdings).length === 0) {
                grid.innerHTML = `
                    <p style="text-align: center; color: rgba(255,255,255,0.6); padding: 2rem;">
                        No holdings yet. Start by buying some cryptocurrency!
                    </p>
                `;
                return;
            }
            
            grid.innerHTML = '';
            
            for (const [symbol, holding] of Object.entries(userPortfolio.holdings)) {
                const crypto = cryptocurrencies[symbol];
                if (!crypto) continue;
                
                const currentValue = holding.quantity * crypto.price;
                const profitLoss = currentValue - holding.totalCost;
                const profitLossPercent = (profitLoss / holding.totalCost) * 100;
                
                const holdingElement = document.createElement('div');
                holdingElement.className = 'holding-item';
                holdingElement.innerHTML = `
                    <div class="crypto-info">
                        <div class="crypto-icon" style="background: ${crypto.color}">
                            ${crypto.icon}
                        </div>
                        <div class="crypto-details">
                            <h3>${crypto.name}</h3>
                            <div class="crypto-symbol">${holding.quantity.toFixed(8)} ${symbol}</div>
                        </div>
                    </div>
                    <div class="crypto-price">
                        <div class="price">$${currentValue.toFixed(2)}</div>
                        <div class="change ${profitLoss >= 0 ? 'positive' : 'negative'}">
                            ${profitLoss >= 0 ? '+' : ''}$${Math.abs(profitLoss).toFixed(2)} (${profitLossPercent.toFixed(2)}%)
                        </div>
                    </div>
                `;
                
                grid.appendChild(holdingElement);
            }
        }

        // Crypto List Rendering
        function renderCryptoList() {
            const container = document.getElementById('cryptoList');
            renderCryptoItems(container, Object.entries(cryptocurrencies).slice(0, 6), true);
        }

        function renderAllMarkets(section) {
            const containerId = section === 'markets' ? 'allMarkets' : 'tradeMarkets';
            const container = document.getElementById(containerId);
            renderCryptoItems(container, Object.entries(cryptocurrencies), section === 'trade');
        }

        function renderCryptoItems(container, cryptoEntries, clickable = false) {
            container.innerHTML = '';
            
            cryptoEntries.forEach(([symbol, crypto]) => {
                const item = document.createElement('div');
                item.className = 'crypto-item';
                if (clickable) {
                    item.style.cursor = 'pointer';
                    item.onclick = () => openTradeModal(symbol);
                }
                
                item.innerHTML = `
                    <div class="crypto-info">
                        <div class="crypto-icon" style="background: ${crypto.color}">
                            ${crypto.icon}
                        </div>
                        <div class="crypto-details">
                            <h3>${crypto.name}</h3>
                            <div class="crypto-symbol">${symbol}</div>
                        </div>
                    </div>
                    <div class="crypto-price">
                        <div class="price">${crypto.price.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}</div>
                        <div class="change ${crypto.change24h >= 0 ? 'positive' : 'negative'}">
                            ${crypto.change24h >= 0 ? '+' : ''}${crypto.change24h.toFixed(2)}%
                        </div>
                    </div>
                `;
                
                container.appendChild(item);
            });
        }

        // Trading Functions
        function openTradeModal(symbol) {
            selectedCrypto = symbol;
            const crypto = cryptocurrencies[symbol];
            
            document.getElementById('tradeModalTitle').textContent = `Trade ${crypto.name}`;
            document.getElementById('tradePricePerCoin').textContent = crypto.price.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
            document.getElementById('tradeModal').style.display = 'block';
            
            // Reset form
            document.getElementById('tradeAmount').value = '';
            setTradeType('buy');
            updateTradeSummary();
        }

        function closeTradeModal() {
            document.getElementById('tradeModal').style.display = 'none';
            selectedCrypto = null;
        }

        function setTradeType(type) {
            currentTradeType = type;
            
            document.getElementById('buyBtn').classList.remove('active');
            document.getElementById('sellBtn').classList.remove('active');
            document.getElementById(`${type}Btn`).classList.add('active');
            
            document.getElementById('executeTradeBtn').textContent = type === 'buy' ? 'Buy Now' : 'Sell Now';
            
            updateTradeSummary();
        }

        function setQuickAmount(amount) {
            const input = document.getElementById('tradeAmount');
            
            if (amount === 'max') {
                if (currentTradeType === 'buy') {
                    input.value = userPortfolio.balance.toFixed(2);
                } else {
                    const holding = userPortfolio.holdings[selectedCrypto];
                    if (holding) {
                        const maxValue = holding.quantity * cryptocurrencies[selectedCrypto].price;
                        input.value = maxValue.toFixed(2);
                    }
                }
            } else {
                input.value = amount;
            }
            
            updateTradeSummary();
        }

        function updateTradeSummary() {
            const amount = parseFloat(document.getElementById('tradeAmount').value) || 0;
            
            if (selectedCrypto && amount > 0) {
                const crypto = cryptocurrencies[selectedCrypto];
                const quantity = amount / crypto.price;
                
                document.getElementById('tradeQuantity').textContent = quantity.toFixed(8);
                document.getElementById('tradeTotal').textContent = amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
            } else {
                document.getElementById('tradeQuantity').textContent = '0.00000000';
                document.getElementById('tradeTotal').textContent = '$0.00';
            }
        }

        function executeTrade() {
            const amount = parseFloat(document.getElementById('tradeAmount').value);
            
            if (!selectedCrypto || !amount || amount <= 0) {
                alert('Please enter a valid amount');
                return;
            }

            const crypto = cryptocurrencies[selectedCrypto];
            const quantity = amount / crypto.price;

            if (currentTradeType === 'buy') {
                if (amount > userPortfolio.balance) {
                    alert('Insufficient balance');
                    return;
                }

                // Execute buy order
                userPortfolio.balance -= amount;
                userPortfolio.totalInvested += amount;

                if (!userPortfolio.holdings[selectedCrypto]) {
                    userPortfolio.holdings[selectedCrypto] = {
                        quantity: 0,
                        totalCost: 0,
                        avgPrice: 0
                    };
                }

                const holding = userPortfolio.holdings[selectedCrypto];
                const newTotalCost = holding.totalCost + amount;
                const newQuantity = holding.quantity + quantity;

                holding.quantity = newQuantity;
                holding.totalCost = newTotalCost;
                holding.avgPrice = newTotalCost / newQuantity;

                // Add transaction
                userPortfolio.transactions.push({
                    type: 'buy',
                    symbol: selectedCrypto,
                    quantity: quantity,
                    price: crypto.price,
                    amount: amount,
                    timestamp: new Date()
                });

                alert(`Successfully bought ${quantity.toFixed(8)} ${selectedCrypto} for ${amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`);

            } else {
                // Execute sell order
                const holding = userPortfolio.holdings[selectedCrypto];
                
                if (!holding || quantity > holding.quantity) {
                    alert('Insufficient holdings');
                    return;
                }

                userPortfolio.balance += amount;
                
                holding.quantity -= quantity;
                const costBasis = (quantity / (holding.quantity + quantity)) * holding.totalCost;
                holding.totalCost -= costBasis;
                userPortfolio.totalInvested -= costBasis;

                if (holding.quantity <= 0) {
                    delete userPortfolio.holdings[selectedCrypto];
                }

                // Add transaction
                userPortfolio.transactions.push({
                    type: 'sell',
                    symbol: selectedCrypto,
                    quantity: quantity,
                    price: crypto.price,
                    amount: amount,
                    timestamp: new Date()
                });

                alert(`Successfully sold ${quantity.toFixed(8)} ${selectedCrypto} for ${amount.toLocaleString('en-US', { style: 'currency', currency: 'USD' })}`);
            }

            updatePortfolioDisplay();
            closeTradeModal();
        }

        // Buy section functions
        function updateBuyForm(symbol) {
            const crypto = cryptocurrencies[symbol];
            if (!crypto) return;
            
            const option = document.querySelector(`.buy-option[data-symbol="${symbol}"]`);
            if (!option) return;
            
            // Update icon and name in the form
            const icon = option.querySelector('i').cloneNode(true);
            const name = option.querySelector('span').textContent;
            
            // In a real app, we would update the form fields based on the selected crypto
        }

        function updateBuySummary() {
            const amount = parseFloat(document.getElementById('buyAmount').value) || 0;
            const selectedOption = document.querySelector('.buy-option.active');
            const symbol = selectedOption ? selectedOption.dataset.symbol : 'BTC';
            const crypto = cryptocurrencies[symbol];
            
            if (amount > 0 && crypto) {
                const quantity = amount / crypto.price;
                const fee = amount * 0.005; // 0.5% fee
                const total = amount + fee;
                
                document.getElementById('buyReceiveAmount').textContent = `${quantity.toFixed(8)} ${symbol}`;
                document.getElementById('buyFeeAmount').textContent = fee.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                document.getElementById('buyTotalAmount').textContent = total.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                
                // Update slider position
                document.getElementById('buyAmountSlider').value = Math.min(amount, 10000);
            } else {
                document.getElementById('buyReceiveAmount').textContent = `0.00000000 ${symbol}`;
                document.getElementById('buyFeeAmount').textContent = '$0.00';
                document.getElementById('buyTotalAmount').textContent = '$0.00';
            }
        }

        // Chart Creation
        function createPortfolioChart() {
            const ctx = document.getElementById('portfolioChart').getContext('2d');
            
            // Generate sample portfolio data for the last 30 days
            const dates = [];
            const values = [];
            const baseValue = 10000;
            
            for (let i = 29; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(date.toLocaleDateString());
                
                // Simulate portfolio growth with some volatility
                const randomChange = (Math.random() - 0.5) * 200;
                const trendChange = i < 15 ? (15 - i) * 10 : 0; // Upward trend in recent days
                values.push(baseValue + randomChange + trendChange);
            }

            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dates,
                    datasets: [{
                        label: 'Portfolio Value',
                        data: values,
                        borderColor: '#00d4ff',
                        backgroundColor: 'rgba(0, 212, 255, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 6,
                        pointHoverBackgroundColor: '#00d4ff',
                        pointHoverBorderColor: '#ffffff',
                        pointHoverBorderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        intersect: false,
                        mode: 'index'
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 15, 35, 0.9)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#00d4ff',
                            borderWidth: 1,
                            cornerRadius: 8,
                            displayColors: false,
                            callbacks: {
                                label: function(context) {
                                    return `${context.parsed.y.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            display: false
                        },
                        y: {
                            display: false
                        }
                    },
                    elements: {
                        point: {
                            radius: 0
                        }
                    }
                }
            });
        }

        function createAllocationChart() {
            const ctx = document.getElementById('allocationChart').getContext('2d');
            
            // Prepare data for allocation chart
            const labels = [];
            const data = [];
            const backgroundColors = [];
            
            // Add cash balance
            if (userPortfolio.balance > 0) {
                labels.push('Cash (USD)');
                data.push(userPortfolio.balance);
                backgroundColors.push('#4CAF50');
            }
            
            // Add crypto holdings
            for (const [symbol, holding] of Object.entries(userPortfolio.holdings)) {
                const crypto = cryptocurrencies[symbol];
                if (crypto) {
                    labels.push(crypto.name);
                    data.push(holding.quantity * crypto.price);
                    backgroundColors.push(crypto.color);
                }
            }
            
            // If no holdings, show empty state
            if (data.length === 0) {
                document.querySelector('.allocation-chart-container').innerHTML = `
                    <p style="text-align: center; color: rgba(255,255,255,0.6); padding: 2rem;">
                        No assets to display allocation
                    </p>
                `;
                return;
            }
            
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: backgroundColors,
                        borderWidth: 0,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                usePointStyle: true,
                                pointStyle: 'circle',
                                padding: 20,
                                color: '#ffffff'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: $${value.toFixed(2)} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Price Simulation
        function simulatePriceUpdates() {
            setInterval(() => {
                // Update crypto prices with realistic volatility
                for (const [symbol, crypto] of Object.entries(cryptocurrencies)) {
                    if (symbol === 'USDT') continue; // Stablecoin
                    
                    const volatility = 0.02; // 2% max change per update
                    const change = (Math.random() - 0.5) * volatility;
                    const newPrice = crypto.price * (1 + change);
                    
                    crypto.price = Math.max(newPrice, crypto.price * 0.8); // Prevent crashes below 20%
                    crypto.change24h += change * 100; // Update 24h change
                    
                    // Keep 24h change realistic
                    crypto.change24h = Math.max(-15, Math.min(15, crypto.change24h));
                }
                
                // Update displays
                updatePortfolioDisplay();
                
                // Update crypto lists if visible
                const currentSection = document.querySelector('.section:not([style*="display: none"])');
                if (currentSection) {
                    const sectionId = currentSection.id;
                    if (sectionId === 'dashboard') {
                        renderCryptoList();
                    } else if (sectionId === 'markets' || sectionId === 'trade') {
                        renderAllMarkets(sectionId);
                    } else if (sectionId === 'portfolio') {
                        updatePortfolioHoldings();
                        createAllocationChart();
                    }
                }
                
                // Update trade modal if open
                if (selectedCrypto && document.getElementById('tradeModal').style.display === 'block') {
                    const crypto = cryptocurrencies[selectedCrypto];
                    document.getElementById('tradePricePerCoin').textContent = crypto.price.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                    updateTradeSummary();
                }
                
                // Update buy section if open
                if (currentSection && currentSection.id === 'buy') {
                    updateBuySummary();
                }
                
            }, 3000); // Update every 3 seconds
        }

        // Load demo data for demonstration
        function loadDemoData() {
            // Add some sample holdings for demo purposes
            userPortfolio.holdings = {
                'BTC': {
                    quantity: 0.1,
                    totalCost: 4000,
                    avgPrice: 40000
                },
                'ETH': {
                    quantity: 2.5,
                    totalCost: 7000,
                    avgPrice: 2800
                },
                'SOL': {
                    quantity: 15,
                    totalCost: 2000,
                    avgPrice: 133.33
                }
            };
            userPortfolio.balance = 5000;
            userPortfolio.totalInvested = 13000;
            updatePortfolioDisplay();
        }

        // Initialize app on page load
        window.addEventListener('load', function() {
            initApp();
            
            // Demo mode - auto login for demonstration
            setTimeout(() => {
                if (!currentUser) {
                    document.getElementById('loginEmail').value = 'demo@cryptovault.com';
                    document.getElementById('loginPassword').value = 'demo123';
                }
            }, 1000);
        });
    </script>
</body>
</html>